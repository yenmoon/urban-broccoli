<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Orange Stop Challenge</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #b40000;
  color: #fff;
  text-align: center;
  margin: 0;
  padding: 20px;
}

.game-area {
  position: relative;
  width: 100%;
  max-width: 360px;
  height: 140px;
  margin: 30px auto;
  background: #8b0000;
  border-radius: 10px;
  overflow: hidden;
}

/* Circle HUAT zone */
.huat-zone {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 60px;
  height: 60px;
  border: 3px solid gold;
  border-radius: 50%;
  transform: translate(-50%, -50%);
}

.orange {
  position: absolute;
  top: 54px;
  font-size: 32px;
  left: -40px;
}

button {
  padding: 12px 30px;
  font-size: 18px;
  border: none;
  border-radius: 6px;
  background: gold;
  color: #8b0000;
  font-weight: bold;
  cursor: pointer;
}

.result {
  margin-top: 20px;
  font-size: 18px;
}
</style>
</head>

<body>

<h1>üçä Orange Stop Challenge</h1>
<p>Tap STOP at the right timing<br><b>Only 10 winners ¬∑ 5 tries</b></p>

<div class="game-area" id="gameArea">
  <div class="huat-zone" id="huat"></div>
  <div class="orange" id="orange">üçä</div>
</div>

<button id="stopBtn">STOP</button>
<div class="result" id="result"></div>

<script>
/* VERSIONED STORAGE (IMPORTANT) */
const TRY_KEY = "v2_tries";
const WIN_KEY = "v2_winners";

const orange = document.getElementById("orange");
const huat = document.getElementById("huat");
const stopBtn = document.getElementById("stopBtn");
const result = document.getElementById("result");
const gameArea = document.getElementById("gameArea");

let pos = -40;
let speed = 3;
let moving = true;

let tries = Number(localStorage.getItem(TRY_KEY)) || 0;
let winners = Number(localStorage.getItem(WIN_KEY)) || 0;

function move() {
  if (!moving) return;
  pos += speed;
  if (pos > gameArea.offsetWidth) pos = -40;
  orange.style.left = pos + "px";
  requestAnimationFrame(move);
}
move();

stopBtn.onclick = () => {
  if (tries >= 5) {
    result.innerHTML = "‚ùå All tries used";
    return;
  }

  moving = false;
  tries++;
  localStorage.setItem(TRY_KEY, tries);

  const o = orange.getBoundingClientRect();
  const h = huat.getBoundingClientRect();

  const dx = (o.left + o.width/2) - (h.left + h.width/2);
  const dy = (o.top + o.height/2) - (h.top + h.height/2);
  const dist = Math.sqrt(dx*dx + dy*dy);

  if (dist <= h.width/2 && winners < 10) {
    winners++;
    localStorage.setItem(WIN_KEY, winners);
    result.innerHTML = "üßß HUAT! Screenshot & comment HUAT";
    return;
  }

  if (winners >= 10) {
    result.innerHTML = "üéÅ All prizes claimed";
    return;
  }

  result.innerHTML = `üòÜ Missed! ${5 - tries} tries left`;
  setTimeout(() => {
    moving = true;
    move();
  }, 800);
};
</script>

</body>
</html>
